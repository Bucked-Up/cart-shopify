(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,(function(r){var n=e[i][1][r];return o(n||r)}),p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _toggleLoading=_interopRequireDefault(require("./toggleLoading.js"));var _dataLayer=require("./dataLayer.js");var _variables=require("../variables.js");var _intellimize=require("./intellimize.js");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const getVariantId=(product,oneCardQuantity)=>{const primaryWrapper=document.querySelector(`[primary="${product.id}"]`);if(primaryWrapper){const secondaryWrapper=document.querySelector(`[secondary="${product.id}"]`);const primary=primaryWrapper.querySelector("input:checked");const secondary=secondaryWrapper.querySelector("input:checked");if(!secondary)return{result:false,wrapper:secondaryWrapper,message:"Select your size."};return{result:product.variants.find((variant=>variant.title.includes(primary.value)&&variant.title.includes(secondary.value))).id}}else if(product.oneCard&&!product.isWhole){const prodContainer=document.querySelector(`[prod-id="${product.id.split("id")[0]}"]`);const choicesContainer=prodContainer.querySelector(".cart__placeholders");const variantsContainer=prodContainer.querySelector(".cart__variant-selection__container");const values=Array.from(choicesContainer.querySelectorAll("button")).map((button=>button.value));if(!values.length||values.length<oneCardQuantity){variantsContainer.classList.add("shake");choicesContainer.querySelectorAll("button").forEach((button=>{button.removeAttribute("variantGot")}));return{result:false,wrapper:variantsContainer,message:"Select your variants."}}const uniqueArray=[];values.forEach((id=>{const existing=uniqueArray.find((item=>item.result===id));if(existing){existing.quantity+=1}else{uniqueArray.push({result:id,quantity:1})}}));return uniqueArray}else{const input=document.querySelector(`[name="${product.id}"]:checked`);if(!input)return{result:false,wrapper:false,message:"Sorry, there was a problem."};return{result:input.value}}};const addAttributes=async(attributes,id,country)=>{const input={input:attributes,cartId:id};const query=`\n    mutation cartAttributesUpdate($input: [AttributeInput!]!, $cartId: ID!) {\n      cartAttributesUpdate(attributes: $input, cartId: $cartId) {\n        cart {\n          id\n          attributes {\n            key\n            value\n          }\n        }\n      }\n    }\n  `;const body={query:query,variables:input};const response=await(0,_variables.handleFetch)({body:body,country:country});return response};const startPopsixle=id=>{if(typeof a10x_dl!="undefined"){a10x_dl.unique_checkout_id=id;session_sync(a10x_dl.s_id,"unique_checkout_id",a10x_dl.unique_checkout_id)}else{console.warn("Popsixcle script not found.")}};const buy=async({data:data,btnDiscount:btnDiscount,lpParams:lpParams,noCart:noCart,btnProducts:btnProducts})=>{const urlParams=new URLSearchParams(window.location.search);const variantId=[];const seenOneCardIds=new Set;for(let i=data.length-1;i>=0;i--){if(data[i].oneCard&&!data[i].isWhole){if(seenOneCardIds.has(data[i].id.split("id")[0])){data.splice(i,1)}else{seenOneCardIds.add(data[i].id.split("id")[0])}}}for(let product of data){if(product.oneCard&&!product.isWhole){const prodQuantity=btnProducts&&btnProducts[product.id.split("id")[0]]?.quantity||lpParams.products[product.id.split("id")[0]].quantity||1;const selectedVariant=getVariantId(product,prodQuantity);if(!selectedVariant[0]?.result)return;selectedVariant.forEach((variant=>{variantId.push({id:variant.result,quantity:variant.quantity,prod:product})}))}else{const inputQtty=+document.getElementById(`qtty-input-${product.id}`)?.value||1;const prodQtty=+document.getElementById(`${product.id}-quantity`)?.innerHTML||1;let quantity=inputQtty*prodQtty;if(product.isWhole){variantId.push(...product.variants.map((variant=>{const prodContainer=document.querySelector(`[prod-id="${product.id.split("id")[0]}"]`);const initialQuantity=+document.getElementById(`${variant.id}-quantity`)?.innerHTML||prodContainer?.getAttribute(`variant-qtty-${variant.id.split("ProductVariant/")[1]||variant.id.split("option")[0]}`);const variantQuantity=inputQtty*(initialQuantity||1);return{id:variant.id,quantity:variantQuantity,prod:product}})))}else if(product.variants.length>1&&(!noCart||noCart&&product.isOptional)){const selectedVariant=getVariantId(product);if(!selectedVariant.result){alert(selectedVariant.message);if(selectedVariant.wrapper)selectedVariant.wrapper.classList.add("shake");return false}variantId.push({id:selectedVariant.result,quantity:quantity,prod:product})}else variantId.push({id:product.variants[0].id,quantity:noCart?product.quantity:quantity,prod:product})}}(0,_toggleLoading.default)();const globalQuantity=+document.getElementById("cart-qtty-input")?.value||1;const obj=variantId.map((variant=>({merchandiseId:variant.id,quantity:globalQuantity*variant.quantity})));if("isBenSys"in lpParams){let string="";variantId.forEach(((variant,i)=>{if(variant.prod.isBenSysShirt){string=string+`&products[${i}][id]=${variant.prod.id.split("id")[0].split("ob")[0]}&products[${i}][quantity]=${variant.quantity}&products[${i}][options][${variant.prod.options[0].id}]=${variant.id.split("-")[0]}&products[${i}][id]=${variant.prod.id.split("id")[0].split("ob")[0]}&products[${i}][quantity]=${variant.quantity}&products[${i}][options][${variant.prod.options[1].id}]=${variant.id.split("-")[1]}`}else{const[variantId,optionID]=variant.id.split("option");string=string+`&products[${i}][id]=${variant.prod.id.split("id")[0].split("ob")[0]}&products[${i}][quantity]=${variant.quantity}&products[${i}][options][${optionID}]=${variantId}`}}));(0,_dataLayer.dataLayerRedirect)(lpParams.dataLayer,data);urlParams.set("cc",lpParams.discountCode||urlParams.get("discount"));if(lpParams.country==="uk")window.location.href=`https://www.buckedup.co.uk/cart/add?${string}&clear=true&${urlParams}`;else window.location.href=`https://${lpParams.country&&lpParams.country!=="us"?lpParams.country+".":""}buckedup.com/cart/add?${string}&clear=true&${urlParams}`}else{const getDiscountCodes=()=>{const hasBumpIncreaseDiscount=document.querySelector("[bump-increase-qtty-input]");let bumpDiscount=hasBumpIncreaseDiscount&&lpParams.bump.discountCode||data.find((prod=>prod.id.includes("ob")))&&lpParams.bump.discountCode;data.filter((prod=>prod.id.includes("ob"))).forEach((prod=>{const discountCode=lpParams.bump.products[prod.id.split("ob")[0]].discountCode;if(discountCode)bumpDiscount=bumpDiscount+"-"+lpParams.bump.products[prod.id.split("ob")[0]].discountCode}));const urlDiscount=urlParams.get("discount");if(lpParams.discountCode!==""||btnDiscount||bumpDiscount||urlDiscount){let discount;if(lpParams.discountCode||btnDiscount){discount=btnDiscount||lpParams.discountCode;if(bumpDiscount){discount=`${discount}-${bumpDiscount}`}}else discount=bumpDiscount;if(urlDiscount)discount=discount?discount+`-${urlDiscount}`:urlDiscount;return discount.split("-")}};const discountCodes=getDiscountCodes();const input={input:{discountCodes:discountCodes,lines:obj}};const query=`\n      mutation cartCreate($input: CartInput) {\n        cartCreate(input: $input) {\n          cart {\n            checkoutUrl\n            id\n          }\n        }\n      }\n    `;const body={query:query,variables:input};try{const response=await(0,_variables.handleFetch)({body:body,country:lpParams.country});const apiData=await response.json();if(!response.ok||apiData.errors)throw new Error(`Api Error. ${JSON.stringify(apiData)}`);const cartId=apiData.data.cartCreate.cart.id;startPopsixle(cartId.split("?key=")[1]);const getClickIds=()=>{const paramsObject={};const allowedParams=["gclid","fbclid","fbc","sccid","ttclid","twclid"];for(let[key,value]of urlParams){if(allowedParams.includes(key)){if(!paramsObject[key]){paramsObject[key]=[]}paramsObject[key].push(value)}}const paramsArray=Object.entries(paramsObject).map((([key,values])=>values.length>1?`${key}=[${values.join(" , ")}]`:`${key}=${values[0]}`));const string=paramsArray.join(" , ");return string};const attributesResponse=await addAttributes([{key:"unique_checkout_id",value:`${cartId.split("?key=")[1]}`},{key:"intellimize_user_id",value:(0,_intellimize.getUserId)()||"undefined"},{key:"affiliate",value:urlParams.get("affiliate")||"undefined"},{key:"click_ids",value:getClickIds()||"undefined"},{key:"utm_source",value:urlParams.get("utm_source")||"undefined"},{key:"utm_medium",value:urlParams.get("utm_medium")||"undefined"},{key:"utm_campaign",value:urlParams.get("utm_campaign")||"undefined"},{key:"utm_content",value:urlParams.get("utm_content")||"undefined"},{key:"utm_adid",value:urlParams.get("utm_adid")||"undefined"},{key:"source_url",value:window.location.href}],cartId,lpParams.country);const attributesData=await attributesResponse.json();if(!attributesResponse.ok)throw new Error(`Attributes Error. ${JSON.stringify(attributesData)}`);(0,_dataLayer.dataLayerRedirect)(lpParams.dataLayer,data);window.location.href=`${apiData.data.cartCreate.cart.checkoutUrl}&${urlParams}`;return true}catch(error){(0,_variables.trySentry)({error:error});(0,_variables.handleError)();return}}};var _default=exports.default=buy},{"../variables.js":11,"./dataLayer.js":2,"./intellimize.js":8,"./toggleLoading.js":9}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getTopLevelDomain=exports.dataLayerStart=exports.dataLayerRedirect=void 0;const getTopLevelDomain=()=>{const fullDomain=window.location.hostname;const domainRegex=/\.([a-z]{2,})\.([a-z]{2,})$/;const match=fullDomain.match(domainRegex);if(match){return`.${match[1]}.${match[2]}`}else{return fullDomain}};exports.getTopLevelDomain=getTopLevelDomain;const setDataLayer=({lpDataLayer:lpDataLayer,event:event,action:action,value:value,currency:currency})=>{window.dataLayer=window.dataLayer||[];window.dataLayer.push({...lpDataLayer,event:event,action:action,value:value,currency:currency,transaction_id:undefined})};const setKlaviyo=(name,item,titles,lpDataLayer)=>{const currentTime=new Date;try{klaviyo.push(["track",name,{...lpDataLayer,...item,products:titles,pagepath:window.location.pathname,pageurl:window.location.href,time:currentTime.getTime()}])}catch(err){console.warn("failed klaviyo\n",err)}};const dataLayerStart=(lpDataLayer,data,discountCode)=>{const titles=data.map((items=>items.title));const item={lpDataLayer:lpDataLayer,event:"pageview",action:"load",value:0};setDataLayer(item);const cookieConfig=`path=/; domain=${getTopLevelDomain()};max-age=3600`;document.cookie=`offer_id=${discountCode};${cookieConfig}`;document.cookie=`page_id=${lpDataLayer.page_id};${cookieConfig}`;setTimeout((()=>{setKlaviyo("Page View",item,titles,lpDataLayer)}),200)};exports.dataLayerStart=dataLayerStart;const dataLayerRedirect=(lpDataLayer,data)=>{const titles=data.map((items=>items.title));const item={lpDataLayer:lpDataLayer,event:"offerview",action:"viewaction",value:0};setDataLayer(item);setKlaviyo("User Redirect Engagement",item,titles,lpDataLayer)};exports.dataLayerRedirect=dataLayerRedirect},{}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.handleOptionalProduct=exports.createCart=void 0;var _buy=_interopRequireDefault(require("./buy.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const addNewPrice=(toBeReplaced,newNumber)=>{if(newNumber==0){toBeReplaced.innerHTML="FREE";return}if(/[0-9]/.test(toBeReplaced.innerHTML)){toBeReplaced.innerHTML=toBeReplaced.innerHTML.replace(/[0-9.]+/,newNumber)}else{toBeReplaced.innerHTML=`$${newNumber}`}};const observePlusPrice=(el,func)=>{const targetNode=el;const observer=new MutationObserver((mutations=>{mutations.forEach((mutation=>{if(mutation.type==="attributes"&&mutation.attributeName==="plus-price"){func()}}))}));observer.observe(targetNode,{attributes:true,attributeFilter:["plus-price"]})};const handleCartPrice=({productWrapper:productWrapper,inCartContainer:inCartContainer,prod:prod})=>{let prevPrice=0;const newPriceElement=document.querySelector(".cart__foot__new-price");const oldPriceElement=document.querySelector(".cart__foot__old-price");const handleNewPrice=({selected:selected,isPlus:isPlus})=>{const newPriceValue=+newPriceElement?.innerHTML.replace(/[^0-9.]/g,"")||0;const oldPriceValue=+oldPriceElement?.innerHTML.replace(/[^0-9.]/g,"")||0;if(isPlus){addNewPrice(newPriceElement,(newPriceValue+selected).toFixed(2));addNewPrice(oldPriceElement,(oldPriceValue+selected).toFixed(2));return}addNewPrice(newPriceElement,(newPriceValue-selected).toFixed(2));addNewPrice(oldPriceElement,(oldPriceValue-selected).toFixed(2))};const handlePriceObserver=()=>{const currentPrice=+productWrapper.getAttribute("plus-price");if(prevPrice&&prevPrice!==currentPrice&&newPriceElement&&oldPriceElement&&inCartContainer.querySelector(`[prod-id='${prod.id}']`)){handleNewPrice({selected:prevPrice})}if(prevPrice!==currentPrice){productWrapper.setAttribute("plus-price",currentPrice);prevPrice=currentPrice;if(newPriceElement&&oldPriceElement&&inCartContainer.querySelector(`[prod-id='${prod.id}']`)){handleNewPrice({selected:currentPrice,isPlus:true})}}};observePlusPrice(productWrapper,handlePriceObserver)};const createInputRadio=({productId:productId,variantId:variantId,text:text,variantPrice:variantPrice="",plusPrice:plusPrice=false,variantPlusPrice:variantPlusPrice,isPlaceholder:isPlaceholder})=>{const wrapper=document.createElement("div");const label=document.createElement("label");const labelText=document.createElement("span");const input=document.createElement("input");wrapper.appendChild(input);wrapper.appendChild(label);const labelBall=document.createElement("span");labelBall.classList.add("label-ball");label.appendChild(labelBall);label.appendChild(labelText);wrapper.classList.add("button-wrapper");labelText.classList.add("label-text");label.setAttribute("for",`${productId}-${variantId}`);label.setAttribute("role","button");labelText.innerHTML=text;input.id=`${productId}-${variantId}`;input.value=`${variantId}`;input.type="radio";input.setAttribute("hidden","");input.name=productId;input.setAttribute("price",variantPrice);input.setAttribute("plus-price",variantPlusPrice||0);input.setAttribute("label-text",text);if(plusPrice){const labelPrice=document.createElement("span");labelPrice.classList.add("label-price");labelPrice.innerHTML=` (${plusPrice})`;labelText.appendChild(labelPrice)}if(isPlaceholder)input.setAttribute("disabled","disabled");return[wrapper,input]};const createButton=variant=>{const button=document.createElement("button");button.type="button";button.value=variant.id;button.classList.add("cart__variant-button");const title=document.createElement("span");title.innerHTML=variant.title;const img=document.createElement("img");img.src=variant.image.src;img.alt=variant.title;button.appendChild(title);button.appendChild(img);return button};const createDropdown=title=>{const dropdown=document.createElement("div");const p=document.createElement("p");const svg='<svg width="20" height="17" viewBox="0 0 20 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12.5981 15.5C11.4434 17.5 8.55662 17.5 7.40192 15.5L1.33975 5C0.185047 3 1.62842 0.499998 3.93782 0.499998L16.0622 0.499999C18.3716 0.5 19.815 3 18.6603 5L12.5981 15.5Z" fill="black"/></svg>';dropdown.setAttribute("role","button");dropdown.classList.add("cart__dropdown");p.innerHTML=title;dropdown.appendChild(p);dropdown.insertAdjacentHTML("beforeend",svg);dropdown.addEventListener("click",(e=>{dropdown.classList.remove("shake");if(e.target.tagName!=="INPUT")dropdown.classList.toggle("active")}));document.addEventListener("click",(e=>{if(!dropdown.contains(e.target)||e.target.tagName==="INPUT")dropdown.classList.remove("active")}));return dropdown};const createProductBase=({prod:prod,img:img,productWrapper:productWrapper})=>{const variantsWrapper=document.createElement("div");const dropdown=createDropdown(prod.variants[0].title);variantsWrapper.classList.add("cart__dropdown__variants");prod.placeholderVariants?.forEach((placeHolder=>{prod.notAvailableVariants.push({id:"placeholder",title:placeHolder.title,availableForSale:false})}));[...prod.variants,...prod.notAvailableVariants].forEach((variant=>{const[wrapper,button]=createInputRadio({isPlaceholder:!variant.availableForSale,productId:prod.id,variantId:variant.id,text:variant.title,variantPrice:variant.price?.amount,variantPlusPrice:variant.plusPrice});variantsWrapper.appendChild(wrapper);variantsWrapper.querySelector("input").checked=true;button.addEventListener("change",(function(){img.src=variant.image.src;img.alt=variant.title;dropdown.querySelector("p").innerHTML=button.getAttribute("label-text");productWrapper&&productWrapper.setAttribute("plus-price",this.getAttribute("plus-price"))}))}));dropdown.appendChild(variantsWrapper);return dropdown};const handleSimpleProduct=({prod:prod,productInfo:productInfo,img:img,productWrapper:productWrapper})=>{const dropdown=createProductBase({prod:prod,img:img,productWrapper:productWrapper});productInfo.appendChild(dropdown)};const handleOptionalProduct=({prod:prod})=>{const img=document.querySelector(`[optional-prod-img="${prod.id}"]`);img.src=prod.variants[0].image.src;const selectorWrapper=document.querySelector(`[optional-prod-selector-wrapper="${prod.id}"]`);const dropdown=createProductBase({prod:prod,img:img});selectorWrapper.appendChild(dropdown)};exports.handleOptionalProduct=handleOptionalProduct;const handleComplexProduct=({prod:prod,productInfo:productInfo,img:img,productWrapper:productWrapper})=>{const primaryOption=prod.options[0];const secondaryOption=prod.options[1];primaryOption.notAvailableValues=primaryOption.values.filter((value=>{for(let variant of[...prod.variants,...prod.notAvailableVariants]){if(variant.selectedOptions[0].value===value&&variant.availableForSale)return false}return true}));primaryOption.values=primaryOption.values.filter((value=>{for(let variant of prod.variants){if(variant.selectedOptions[0].value===value&&variant.availableForSale)return true}return false}));const initialVariant=prod.variants.find((variant=>variant.title.includes(primaryOption.values[0])));img.src=initialVariant.image.src;img.alt=initialVariant.title;const createBase=text=>{const dropdown=createDropdown(text);const variantsWrapper=document.createElement("div");variantsWrapper.classList.add("cart__dropdown__variants");return[dropdown,variantsWrapper]};const[primaryDropdown,primaryVariantsWrapper]=createBase(primaryOption.values[0]);const secondaryVariantsWrapper=document.createElement("div");secondaryVariantsWrapper.classList.add("cart__secondary-wrapper");primaryVariantsWrapper.setAttribute("primary",prod.id);secondaryVariantsWrapper.setAttribute("secondary",prod.id);const findPlusPrice=(value,variants)=>{for(let variant of variants){if(variant.title.includes(value))return variant.title.split("(")[1]?.split(")")[0]}};const getNewName=value=>{switch(value){case"Small":return"S";case"Medium":return"M";case"Large":return"L";case"X-Large":return"XL";default:return value}};const placeHolders=["S","M","L","XL","2XL","3XL","4XL"].map((size=>{const wrapper=document.createElement("div");const textWrapper=document.createElement("div");const text=document.createElement("span");wrapper.classList.add("button-wrapper");wrapper.classList.add("button-wrapper--placeholder");textWrapper.classList.add("placeholder__text-wrapper");text.classList.add("label-text");text.innerHTML=size;text.setAttribute("size",size);wrapper.appendChild(textWrapper);textWrapper.appendChild(text);return wrapper}));const updateSecondaryOptions=primarySelected=>{const prevSelected=secondaryVariantsWrapper.querySelector(["input:checked"]);secondaryVariantsWrapper.innerHTML="";productWrapper.setAttribute("plus-price",0);placeHolders.forEach((placeholder=>secondaryVariantsWrapper.appendChild(placeholder)));prod.variants.forEach((variant=>{const newValue=variant.selectedOptions[1].value;const plusPrice=findPlusPrice(newValue,prod.variants);if(variant.title.includes(primarySelected)&&!secondaryVariantsWrapper.querySelector("label")?.innerHTML.includes(newValue)){const[wrapper,button]=createInputRadio({productId:secondaryOption.id,variantId:newValue,text:getNewName(newValue),plusPrice:plusPrice,variantPlusPrice:variant.plusPrice});button.addEventListener("change",(function(){productWrapper.setAttribute("plus-price",this.getAttribute("plus-price"));secondaryVariantsWrapper.classList.remove("shake")}));if(prevSelected?.value===newValue){button.checked=true;productWrapper.setAttribute("plus-price",button.getAttribute("plus-price"))}const placeholder=placeHolders.find((placeHolder=>placeHolder.querySelector(`[size="${getNewName(newValue)}"]`)));secondaryVariantsWrapper.insertBefore(wrapper,placeholder);placeholder.remove()}}))};primaryOption.values.forEach((option=>{const[wrapper,button]=createInputRadio({productId:primaryOption.id,variantId:option,text:option});button.addEventListener("change",(()=>{for(let variant of prod.variants){if(variant.title.includes(button.value)){img.src=variant.image.src;img.alt=button.getAttribute("label-text");primaryDropdown.querySelector("p").innerHTML=button.getAttribute("label-text");break}}updateSecondaryOptions(button.value)}));primaryVariantsWrapper.appendChild(wrapper)}));primaryOption.notAvailableValues.forEach((option=>{const[wrapper,button]=createInputRadio({isPlaceholder:true,productId:primaryOption.id,variantId:option,text:option});primaryVariantsWrapper.appendChild(wrapper)}));primaryVariantsWrapper.querySelector("input").checked=true;primaryDropdown.appendChild(primaryVariantsWrapper);updateSecondaryOptions(primaryOption.values[0]);productInfo.appendChild(primaryDropdown);productInfo.appendChild(secondaryVariantsWrapper)};const createQtty=({inputId:inputId,maxQtty:maxQtty,addButton:addButton,price:price})=>{const updateTitle=qtty=>{if(price){const separetedString=addButton.innerHTML.split("$");separetedString[1]=(price*qtty).toFixed(2);addButton.innerHTML=separetedString.join("$")}};const plusBtn=document.createElement("button");plusBtn.classList.add("btn-plus");plusBtn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M440-440H200v-80h240v-240h80v240h240v80H520v240h-80v-240Z"/></svg>';const minusBtn=document.createElement("button");minusBtn.classList.add("btn-minus");minusBtn.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M200-440v-80h560v80H200Z"/></svg>';const qttyInput=document.createElement("input");qttyInput.id=inputId||"cart-qtty-input";qttyInput.value=1;qttyInput.type="number";qttyInput.addEventListener("input",(()=>{if(qttyInput.value<=0){qttyInput.value=1;updateTitle(qttyInput.value)}if(maxQtty&&qttyInput.value>maxQtty){qttyInput.value=maxQtty;updateTitle(qttyInput.value)}}));plusBtn.addEventListener("click",(()=>{if(!maxQtty||qttyInput.value<maxQtty){qttyInput.value=+qttyInput.value+1;updateTitle(qttyInput.value)}}));minusBtn.addEventListener("click",(()=>{if(qttyInput.value>1){qttyInput.value=+qttyInput.value-1;updateTitle(qttyInput.value)}}));const qttyWrapper=document.createElement("div");qttyWrapper.classList.add("qtty-wrapper");qttyWrapper.appendChild(minusBtn);qttyWrapper.appendChild(qttyInput);qttyWrapper.appendChild(plusBtn);return[qttyWrapper,qttyInput]};const increasePlaceholders=prodWrapper=>{const placeHoldersDiv=prodWrapper.querySelector(".cart__placeholders");const placeHolder=placeHoldersDiv.querySelector(".cart__variant-placeholder");placeHoldersDiv.appendChild(placeHolder.cloneNode(true))};const handleOneCardProduct=({productInfo:productInfo})=>{const placeHoldersDiv=document.createElement("div");placeHoldersDiv.classList.add("cart__placeholders");const placeHolder=document.createElement("div");placeHolder.classList.add("cart__variant-placeholder");const title=document.createElement("p");title.innerHTML="Your Choice";const img=document.createElement("div");placeHolder.appendChild(title);placeHolder.appendChild(img);placeHoldersDiv.appendChild(placeHolder);productInfo.appendChild(placeHoldersDiv)};const createPlaceholders=({prod:prod,selectionDiv:selectionDiv,productWrapper:productWrapper})=>{selectionDiv=document.createElement("div");selectionDiv.classList.add("cart__variant-selection");const title=document.createElement("p");title.innerHTML=`Select your variants: `;selectionDiv.appendChild(title);const selectionContainer=document.createElement("div");selectionContainer.classList.add("cart__variant-selection__container");selectionDiv.appendChild(selectionContainer);prod.placeholderVariants?.forEach((placeHolder=>{prod.notAvailableVariants.push({id:"placeholder",title:placeHolder.title,availableForSale:false,image:{src:placeHolder.image}})}));[...prod.variants,...prod.notAvailableVariants].forEach((variant=>{const btn=createButton(variant);selectionContainer.appendChild(btn);if(!variant.availableForSale)btn.setAttribute("disabled","disabled");else btn.addEventListener("click",(()=>{const prodContainer=document.querySelector(`[prod-id="${prod.id.split("id")[0]}"] .cart__placeholders`);if(btn.parentElement.classList.contains("cart__variant-selection__container")){const placeholder=prodContainer.querySelector('.cart__variant-placeholder:not([style*="display: none"])');const firstChild=prodContainer.querySelector("*");const prevPlusPrice=+productWrapper.getAttribute("plus-price");productWrapper.setAttribute("plus-price",prevPlusPrice+ +(variant.plusPrice||0));const clone=btn.cloneNode(true);clone.addEventListener("click",(()=>{const prevPlusPrice=+productWrapper.getAttribute("plus-price");productWrapper.setAttribute("plus-price",prevPlusPrice-+(variant.plusPrice||0));prodContainer.querySelector('.cart__variant-placeholder[style*="display: none"]').style.display="";selectionDiv.style.display="";clone.remove()}));prodContainer.insertBefore(clone,firstChild);placeholder.style.display="none";selectionContainer.classList.remove("shake");if(!prodContainer.querySelector('.cart__variant-placeholder:not([style*="display: none"])'))selectionDiv.style.display="none"}}))}));return selectionDiv};const createBumpAddButton=({data:data,container:container,wrapper:wrapper,inCartContainer:inCartContainer,prod:prod,price:price,lpParams:lpParams})=>{const newPriceElement=document.querySelector(".cart__foot__new-price");const oldPriceElement=document.querySelector(".cart__foot__old-price");const isIncrease=typeof prod==="string"&&prod==="increase";const addButton=document.createElement("button");addButton.classList.add("add-button");addButton.innerHTML=`Add to cart for only +$${price.toFixed(2)}`;const handleAddButtonText=()=>{if(addButton.classList.contains("bump-added"))return;addButton.innerHTML=`Add to cart for only +$${(price+ +wrapper.getAttribute("plus-price")).toFixed(2)}`};observePlusPrice(wrapper,handleAddButtonText);const getOrderBumpIncreaseProds=()=>data.filter((prod=>!lpParams.bump.products["increase"].discart?.includes(+prod.id)));addButton.addEventListener("click",(()=>{const plusPrice=wrapper.getAttribute("plus-price");const totalPrice=price+ +plusPrice;const newPriceValue=+newPriceElement?.innerHTML.replace(/[^0-9.]/g,"")||0;const oldPriceValue=+oldPriceElement?.innerHTML.replace(/[^0-9.]/g,"")||0;if(addButton.classList.contains("bump-added")){addButton.classList.remove("bump-added");addButton.innerHTML=`Add to cart for only +$${(price+ +wrapper.getAttribute("plus-price")).toFixed(2)}`;container.appendChild(wrapper);if(isIncrease){document.querySelectorAll("[bump-increase-qtty-input]").forEach((input=>input.remove()))}else{data.splice(data.indexOf(prod),1)}if(newPriceElement&&oldPriceElement){addNewPrice(newPriceElement,(newPriceValue-totalPrice).toFixed(2));addNewPrice(oldPriceElement,(oldPriceValue-totalPrice).toFixed(2))}}else{if(isIncrease){getOrderBumpIncreaseProds().forEach((prod=>{const hiddenInput=document.createElement("input");hiddenInput.type="hidden";hiddenInput.setAttribute("bump-increase-qtty-input","");hiddenInput.value=lpParams.bump.products["increase"].quantity;hiddenInput.id=`qtty-input-${prod.id}`;document.body.appendChild(hiddenInput)}))}else{data.push(prod)}addButton.classList.add("bump-added");addButton.innerHTML="Added to cart";inCartContainer.appendChild(wrapper);if(newPriceElement&&oldPriceElement){addNewPrice(newPriceElement,(newPriceValue+totalPrice).toFixed(2));addNewPrice(oldPriceElement,(oldPriceValue+totalPrice).toFixed(2))}}}));return addButton};const createProduct=({prod:prod,isVariant:isVariant,isOrderBump:isOrderBump,orderBumpsContainer:orderBumpsContainer,inCartContainer:inCartContainer,quantity:quantity,lpParams:lpParams,data:data})=>{let prevProdWrapper;const productWrapper=document.createElement("div");if(prod!=="increase")prevProdWrapper=document.querySelector(`[prod-id="${prod.id.split("id")[0]}"]`);let selectionDiv=undefined;if(prod.oneCard&&!prod.isWhole){if(prod.oneCard&&!prevProdWrapper){selectionDiv=createPlaceholders({prod:prod,selectionDiv:selectionDiv,productWrapper:productWrapper})}else if(prod.oneCard){increasePlaceholders(prevProdWrapper);return undefined}}productWrapper.classList.add("cart__product");if(prod!=="increase")productWrapper.setAttribute("prod-id",isVariant?isVariant.id:prod.id.split("id")[0]);handleCartPrice({productWrapper:productWrapper,inCartContainer:inCartContainer,prod:prod});const productContainer=document.createElement("div");productContainer.classList.add("cart__product__container");productWrapper.appendChild(productContainer);if(selectionDiv)productWrapper.appendChild(selectionDiv);const productInfo=document.createElement("div");productInfo.classList.add("cart__product__info");const title=document.createElement("p");title.classList.add("cart__product__title");title.innerHTML=isVariant?.title||prod.title||lpParams.bump.products[prod].title;productInfo.appendChild(title);if(isVariant){const variantTitle=document.createElement("p");variantTitle.classList.add("cart__product__variant-title");variantTitle.innerHTML=prod.title;productInfo.appendChild(variantTitle)}let img=undefined;if(!prod.oneCard||prod.oneCard&&prod.isWhole){const imgWrapper=document.createElement("div");imgWrapper.classList.add("cart__product__img-wrapper");img=document.createElement("img");if(prod.oneCard&&prod.isWhole){img.src=lpParams.products[prod.id].image;img.alt=lpParams.products[prod.id].title;prod.variants.forEach((variant=>{const variantId=variant.id.split("ProductVariant/")[1]||variant.id.split("option")[0];const variantsOptions=lpParams.products[prod.id].variantsOptions;if(variantsOptions){const variantQuantity=variantsOptions[variantId]?.quantity;if(variantQuantity)productWrapper.setAttribute(`variant-qtty-${variantId}`,variantQuantity)}}))}else if(isVariant){img.src=prod.image.src;img.alt=prod.title}else{if(prod!=="increase"){img.src=prod.variants[0].image.src;img.alt=prod.variants[0].title}else{img.src=lpParams.bump.products[prod].image}}imgWrapper.appendChild(img);productContainer.appendChild(imgWrapper);if(quantity>1&&(isVariant||prod.variants?.length<=1)){const quantityLabel=document.createElement("span");quantityLabel.id=`${isVariant?.id||prod.id}-quantity`;quantityLabel.innerHTML=quantity||1;imgWrapper.appendChild(quantityLabel)}}productContainer.appendChild(productInfo);if(prod!=="increase"&&!isVariant&&prod.variants.length>1&&!prod.isWhole){if(prod.options.length>1)handleComplexProduct({prod:prod,productInfo:productInfo,img:img,productWrapper:productWrapper});else if(!prod.oneCard)handleSimpleProduct({prod:prod,productInfo:productInfo,img:img,productWrapper:productWrapper});else handleOneCardProduct({prod:prod,productInfo:productInfo,productWrapper:productWrapper})}if(isOrderBump){const addWrapper=document.createElement("div");addWrapper.classList.add("add-wrapper");const addButton=createBumpAddButton({data:data,container:orderBumpsContainer,wrapper:productWrapper,inCartContainer:inCartContainer,prod:prod,price:lpParams.bump.products[prod.id?.split("ob")[0]]?.price||lpParams.bump.price,lpParams:lpParams});addWrapper.appendChild(addButton);let qttyWrapper;if(lpParams.bump.hasQtty){const maxQtty=typeof lpParams.bump.hasQtty==="number"?lpParams.bump.hasQtty:false;[qttyWrapper]=createQtty({inputId:`qtty-input-${prod.id}`,maxQtty:maxQtty,addButton:addButton,price:lpParams.bump.price});addWrapper.appendChild(qttyWrapper)}productInfo.appendChild(addWrapper)}return productWrapper};const createCart=(data,orderBumpData,lpParams)=>{const domCartContainer=document.querySelector("[cart-container]")||false;const cartWrapper=document.createElement("div");const cartOverlay=document.createElement("div");const cart=document.createElement("div");cartWrapper.classList.add("cart-wrapper");cartOverlay.classList.add("cart-overlay");cart.classList.add("cart");if(domCartContainer){domCartContainer.appendChild(cart)}else{cartWrapper.appendChild(cartOverlay);cartWrapper.appendChild(cart);document.body.appendChild(cartWrapper)}const cartHead=document.createElement("div");const cartIcon=document.createElement("p");const cartTitle=document.createElement("p");cartTitle.classList.add("cart__head__title");const closeCartButton=document.createElement("button");cartHead.classList.add("cart__head");closeCartButton.classList.add("cart__head__close-button");cartIcon.innerHTML=`\n  <svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="M280-80q-33 0-56.5-23.5T200-160q0-33 23.5-56.5T280-240q33 0 56.5 23.5T360-160q0 33-23.5 56.5T280-80Zm400 0q-33 0-56.5-23.5T600-160q0-33 23.5-56.5T680-240q33 0 56.5 23.5T760-160q0 33-23.5 56.5T680-80ZM208-800h590q23 0 35 20.5t1 41.5L692-482q-11 20-29.5 31T622-440H324l-44 80h480v80H280q-45 0-68-39.5t-2-78.5l54-98-144-304H40v-80h130l38 80Z"/></svg>`;closeCartButton.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" height="24" viewBox="0 -960 960 960" width="24"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>';if(!domCartContainer){cartHead.appendChild(cartIcon);cartHead.appendChild(cartTitle);cartHead.appendChild(closeCartButton);cart.append(cartHead)}const productsContainer=document.createElement("div");const inCartContainer=document.createElement("div");const orderBumpsContainer=document.createElement("div");productsContainer.classList.add("cart__prod-container");inCartContainer.classList.add("cart__in-cart-container");orderBumpsContainer.classList.add("cart__order-bumps-container");productsContainer.appendChild(inCartContainer);productsContainer.appendChild(orderBumpsContainer);cart.appendChild(productsContainer);[cartOverlay,closeCartButton].forEach((el=>{el.addEventListener("click",(()=>{for(let i=0;i<data.length;i++){if(data[i].id.includes("ob")){data.splice(i,1);i--}}document.querySelectorAll("[bump-increase-qtty-input]").forEach((input=>input.remove()));document.querySelector(".cart__foot__price-div-wrapper")?.remove();cartWrapper.classList.toggle("active");document.body.classList.toggle("no-scroll")}))}));const cartFoot=document.createElement("div");cartFoot.classList.add("cart__foot");const priceDivWrapper=document.createElement("div");priceDivWrapper.classList.add("cart__foot__price-div-wrapper");const totalText=document.createElement("p");totalText.innerHTML="Total: ";totalText.classList.add("cart__foot__total-text");const oldNewPriceWrapper=document.createElement("div");oldNewPriceWrapper.classList.add("cart__foot__price-div");const oldPrice=document.createElement("p");oldPrice.classList.add("cart__foot__old-price");const newPrice=document.createElement("p");newPrice.classList.add("cart__foot__new-price");priceDivWrapper.appendChild(totalText);priceDivWrapper.appendChild(oldNewPriceWrapper);oldNewPriceWrapper.appendChild(oldPrice);oldNewPriceWrapper.appendChild(newPrice);let buyButton=document.createElement("button");buyButton.classList.add("buy-button");buyButton.innerHTML="BUY NOW";cartFoot.appendChild(buyButton);if(lpParams.hasQtty){cartFoot.appendChild(createQtty({maxQtty:lpParams.hasQtty>1?lpParams.hasQtty:undefined})[0])}cart.appendChild(cartFoot);const replaceElement=el=>{const elClone=el.cloneNode(true);el.parentNode.replaceChild(elClone,el);return elClone};const titleDiv=document.createElement("div");titleDiv.classList.add("cart__title-div");const title=document.createElement("p");title.innerHTML="YOU MAY ALSO LIKE";titleDiv.appendChild(title);const updateCartProducts=(data,btnDiscount,btnProducts,btnPrices)=>{inCartContainer.innerHTML="";orderBumpsContainer.innerHTML="";orderBumpsContainer.appendChild(titleDiv);buyButton=replaceElement(buyButton);if(lpParams.prices||btnPrices){const actualPrices=btnPrices||lpParams.prices;oldPrice.innerHTML=actualPrices.old;newPrice.innerHTML=actualPrices.new;cartFoot.insertBefore(priceDivWrapper,cartFoot.querySelector("*"))}data.forEach((prod=>{const quantity=btnProducts&&btnProducts[prod.id]?.quantity||lpParams.products[prod.id]?.quantity;if(prod.isWhole&&!prod.oneCard){prod.variants.forEach((variant=>{const variantsOptions=lpParams.products[prod.id]?.variantsOptions||false;let variantQuantity;if(variantsOptions&&variant.id.includes("ProductVariant/"))variantQuantity=variantsOptions[variant.id.split("ProductVariant/")[1]]?.quantity;else if(variantsOptions&&variant.id.includes("option"))variantQuantity=variantsOptions[variant.id.split("option")[0]]?.quantity;else if(variantsOptions)variantQuantity=variantsOptions[variant.id]?.quantity;inCartContainer.appendChild(createProduct({prod:variant,lpParams:lpParams,isVariant:{title:prod.title,id:variant.id},quantity:variantQuantity||quantity,data:data}))}))}else{const prodCard=createProduct({prod:prod,quantity:quantity,lpParams:lpParams,data:data,inCartContainer:inCartContainer});if(prodCard)inCartContainer.appendChild(prodCard)}}));if(orderBumpData)orderBumpData.forEach((prod=>{orderBumpsContainer.appendChild(createProduct({prod:prod,lpParams:lpParams,isOrderBump:true,inCartContainer:inCartContainer,orderBumpsContainer:orderBumpsContainer,data:data}))}));buyButton.addEventListener("click",(async()=>{const result=await(0,_buy.default)({data:data,btnDiscount:btnDiscount,lpParams:lpParams,btnProducts:btnProducts})}));cartWrapper.classList.toggle("active");if(!domCartContainer)document.body.classList.toggle("no-scroll");const updateCartTitle=()=>{cartTitle.innerHTML=`SHOPPING CART (${inCartContainer.childElementCount})`};const observer=new MutationObserver((()=>{updateCartTitle()}));observer.observe(inCartContainer,{childList:true});updateCartTitle()};return updateCartProducts};exports.createCart=createCart},{"./buy.js":1}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.tryFbq=exports.default=void 0;var _variables=require("../variables.js");var _handlePageView=_interopRequireDefault(require("./handlePageView.js"));var _intellimize=_interopRequireDefault(require("./intellimize.js"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const getCheckoutDomain=country=>{switch(country){case"ca":return"cad.buckedup.com";case"au":return"aud.buckedup.com";case"uk":return"gbp.buckedup.com";default:return"secure.buckedup.com"}};const tryFbq=consent=>{try{fbq("consent",consent)}catch(e){console.warn("failed fbq",e)}};exports.tryFbq=tryFbq;const tryGtag=({consent:consent,step:step})=>{try{gtag("consent",step,{ad_storage:consent,analytics_storage:consent,personalization_storage:consent})}catch(e){console.warn("Error on gtag",e)}};const handleCookieBanner=({country:country})=>{const STOREFRONT_DOMAIN="buckedup.com";const CHECKOUT_DOMAIN=getCheckoutDomain(country);const SF_API_TOKEN=(0,_variables.getAccessToken)(country);tryGtag({consent:"denied",step:"default"});try{privacyBanner.loadBanner({storefrontAccessToken:SF_API_TOKEN,checkoutRootDomain:CHECKOUT_DOMAIN,storefrontRootDomain:STOREFRONT_DOMAIN});document.addEventListener("visitorConsentCollected",(event=>{const eventDetail=event.detail;if(eventDetail.analyticsAllowed&&eventDetail.thirdPartyMarketingAllowed&&eventDetail.saleOfDataAllowed){tryFbq("grant");tryGtag({consent:"granted",step:"update"});(0,_intellimize.default)()}else{tryFbq("revoke");tryGtag({consent:"denied",step:"update"})}}))}catch(err){console.warn("Error on cookie banner.",err)}};var _default=exports.default=handleCookieBanner},{"../variables.js":11,"./handlePageView.js":5,"./intellimize.js":8}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;const sendPageView=async()=>{try{const body={page:window.location.pathname};const response=await fetch("https://webhook-processor-production-0316.up.railway.app/webhook/conversion",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(body)});if(!response.ok)throw new Error(response.statusMessage)}catch(e){console.error("Error on pageView: ",e)}};const handlePageView=async()=>{const pageViewKey="pageViewSent";if(!sessionStorage.getItem(pageViewKey)){sessionStorage.setItem(pageViewKey,"true");sendPageView()}};var _default=exports.default=handlePageView},{}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _variables=require("../../variables.js");var _handleCart=require("../handleCart.js");const filterVariants=(data,products,isOrderBump)=>{const ids=Object.keys(products);const isNotAvailable=variant=>variant.node.availableForSale===false;const isAvailable=variant=>variant.node.availableForSale===true;for(let key in products){if(!key.includes("-"))continue;const keySplitted=key.split("-");for(let prodData of data){if(prodData.id.includes(keySplitted[0])){prodData.id=`${prodData.id}-${keySplitted[1]}`;break}}}ids.forEach((id=>{const prod=data.find((prod=>prod.id.includes(id)));const currentProduct=products[id];if(isOrderBump){prod.id=prod.id+"ob"}if("title"in currentProduct){prod.title=currentProduct.title}if(Object.keys(products).length>0){prod.notAvailableVariants=prod.variants.edges.filter((edge=>!edge.node.availableForSale)).map((obj=>obj.node));prod.variants=prod.variants.edges.filter((edge=>edge.node.availableForSale));if(currentProduct.title)prod.title=currentProduct.title;if(currentProduct.isOptional)prod.isOptional=currentProduct.isOptional;if(currentProduct.hasQtty)prod.hasQtty=hasQtty;if(currentProduct.noPriceUp)prod.noPriceUp=true;if(currentProduct.placeholderVariants)prod.placeholderVariants=currentProduct.placeholderVariants;if(currentProduct.variants)prod.variants=prod.variants.filter((filteredVariant=>currentProduct.variants.includes(+filteredVariant.node.id.split("ProductVariant/")[1])));if(currentProduct.variantOf){const mainProd=data.find((prod=>prod.id.includes(currentProduct.variantOf)));prod.variants.forEach((variant=>{mainProd.variants.push(variant)}))}if(currentProduct.isWhole){prod.availableForSale=prod.variants.every(isAvailable);prod.isWhole=true}else if(currentProduct.variants)prod.availableForSale=!prod.variants.every(isNotAvailable);if(currentProduct.oneCard&&prod.variants.length>1)prod.oneCard=true}}))};const fetchProduct=async({products:products,isOrderBump:isOrderBump=false,country:country})=>{if(isOrderBump&&"increase"in products)return["increase"];const ids=Object.keys(products);const query=`\n  { \n    nodes(ids: [${ids.map((id=>`"gid://shopify/Product/${id}"`))}]) {\n      ... on Product {\n        availableForSale\n        title\n        id\n        options{\n          ... on ProductOption{\n            id\n            name\n            values\n          }\n        }\n        variants(first: 100) {\n          edges{\n            node{\n              id\n              title\n              availableForSale\n              selectedOptions{\n                name\n                value\n              }\n              price{\n                amount\n              }\n              image {\n                ... on Image {\n                  src\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  }\n  `;try{const response=await(0,_variables.handleFetch)({body:{query:query},country:country});let data=await response.json();if(!response.ok)throw new Error(`Error Fetching Api. ${JSON.stringify(data)}`);if(data.data.nodes.some((prod=>prod===null)))throw new Error(`Missing Product. ${JSON.stringify(data)}`);data=data.data.nodes;filterVariants(data,products,isOrderBump);data.forEach((prod=>{if(!prod.availableForSale){(0,_variables.trySentry)({message:`Out of stock: ${prod.id} ${prod.title}`});return}prod.id=prod.id.split("/").slice(-1)[0];let minPrice=Infinity;for(let key in prod.variants){prod.variants[key]=prod.variants[key].node;prod.variants[key].title=prod.variants[key].title.split("(")[0];if(+prod.variants[key].price.amount<minPrice)minPrice=prod.variants[key].price.amount}if(!prod.noPriceUp)for(let key in prod.variants){if(+prod.variants[key].price.amount>minPrice){const plusPrice=(prod.variants[key].price.amount-minPrice).toFixed(2);const string=` (+$${plusPrice})`;prod.variants[key].title=prod.variants[key].title+string;prod.variants[key].plusPrice=plusPrice}}if(prod.isOptional)(0,_handleCart.handleOptionalProduct)({prod:prod})}));return data}catch(error){return Promise.reject(error)}};var _default=exports.default=fetchProduct},{"../../variables.js":11,"../handleCart.js":3}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _variables=require("../../variables.js");const checkStock=(prod,mainId,secondId)=>prod.stock[`[${mainId},${secondId}]`]!==undefined&&prod.stock[`[${mainId},${secondId}]`]>0||prod.stock[`[${secondId},${mainId}]`]!==undefined&&prod.stock[`[${secondId},${mainId}]`]>0;const removeParenthesesContent=str=>str.replace(/\([^)]*\)/g,"").trim();const fetchProductBen=async({products:products,country:country,isOrderBump:isOrderBump})=>{if(isOrderBump&&"increase"in products)return["increase"];const convertData=data=>{const isNotAvailable=variant=>variant.availableForSale===false;const isAvailable=variant=>variant.availableForSale===true;const newData=[];for(let prod of data){const isNormalProduct=Object.hasOwn(prod.options[0].values[0],"in_stock");const currentProd=products[prod.id];if(!isNormalProduct){if(Object.values(prod.stock).every((val=>val<=0))){(0,_variables.trySentry)({message:`Out of stock: ${prod.id}`});data.noStock=true;return}const mainOption=prod.options[0];const secondaryOption=prod.options[1];for(let mainValue of mainOption.values){let hasStock=false;for(let secondValue of secondaryOption.values){if(checkStock(prod,mainValue.id,secondValue.id)){hasStock=true}}if(!hasStock)mainOption.values=mainOption.values.filter((value=>value.id!==mainValue.id))}const newProd={};newProd.availableForSale=true;newProd.options=[];newProd.id=`${prod.id}`;if(isOrderBump){newProd.id=newProd.id+"ob"}newProd.title=currentProd.title||prod.name;newProd.variants=[];newProd.notAvailableVariants=[];newProd.hasQtty=currentProd.hasQtty;newProd.isBenSysShirt=true;prod.options.forEach((option=>{newProd.options.push({id:option.id,name:option.name,values:option.values.map((value=>value.name))})}));prod.options[0].values.forEach((value0=>{prod.options[1].values.forEach((value1=>{const availableForSale=checkStock(prod,value0.id,value1.id);const variantObj={id:`${value0.id}-${value1.id}`,title:`${value0.name} / ${value1.name}`,availableForSale:availableForSale,selectedOptions:[{name:prod.options[0].name,value:removeParenthesesContent(value0.name)},{name:prod.options[1].name,value:removeParenthesesContent(value1.name)}],image:{src:value0.images[0]}};if(availableForSale)newProd.variants.push(variantObj);else newProd.notAvailableVariants.push(variantObj)}))}));newData.push(newProd)}else{for(let option of prod.options){const newProd={};if(!option.values.length==0){option.values=option.values.filter((value=>value.in_stock));if(option.values.length<=0){(0,_variables.trySentry)({message:`Out of stock: ${prod.id}`});newProd.availableForSale=false;newData.push(newProd);continue}}newProd.availableForSale=true;newProd.options=[];newProd.id=`${prod.id}`;if(isOrderBump){newProd.id=newProd.id+"ob"}newProd.title=currentProd.title||prod.name;newProd.variants=[];newProd.notAvailableVariants=[];newProd.hasQtty=currentProd.hasQtty;if(currentProd.variants)option.values=option.values.filter((value=>currentProd.variants.includes(value.id)));option.values.forEach((value=>{const newVariant={};newVariant.availableForSale=value.in_stock;newVariant.id=`${value.id}option${option.id}`;newVariant.image={src:value.images[0]};newVariant.price={amount:`${Number(prod.price.slice(1))-Number(value.price.slice(1))}`};newVariant.title=value.name;if(newVariant.availableForSale)newProd.variants.push(newVariant);else newProd.notAvailableVariants.push(newVariant)}));if(currentProd.isWhole){newProd.availableForSale=newProd.variants.every(isAvailable);newProd.isWhole=true}else if(currentProd.variants)newProd.availableForSale=!newProd.variants.every(isNotAvailable);if(currentProd.oneCard&&newProd.variants?.length>1)newProd.oneCard=true;newData.push(newProd)}}}return newData};const ids=Object.keys(products);const data=await(0,_variables.getBenProducts)({ids:ids,country:country});return convertData(data)};var _default=exports.default=fetchProductBen},{"../../variables.js":11}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getUserId=exports.default=void 0;let userId;const getUserId=()=>userId;exports.getUserId=getUserId;const setUserId=(i=0)=>{try{userId=intellimize.getUserId();if(userId){const userDomain="shopifyCheckout";intellimize.setUserId(userDomain,userId);return}if(i>=50){console.warn("no id for intellimize");return}setTimeout((()=>setUserId(i+1)),100)}catch(e){setTimeout((()=>setUserId(i+1)),100)}};const handleIntellimize=()=>{try{intellimize.ready((function(){setUserId()}))}catch(e){console.error(e)}};var _default=exports.default=handleIntellimize},{}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;const body=document.querySelector("body");const loadingDiv=document.createElement("div");const loadingP=document.createElement("p");loadingP.innerHTML="We are currently experiencing issues with our Shopify Storefront.<br>While issues are being resolved, we will redirect you to our main website momentarily!";loadingP.id="error-message-modal";const loadingSvg='<svg xmlns="http://www.w3.org/2000/svg" width="100" viewBox="0 0 98.466 107.356"><g transform="translate(-433.543 -156.68)"><path d="M521.728,160.137a8.377,8.377,0,0,0-1.208-.865,4.807,4.807,0,0,0,1.005,3.02c.791,1.453,1.6,2.9,2.339,4.379.663,1.321,1.294,2.663,1.928,4a5.081,5.081,0,0,1,.474,3.955c-1.579-1.018-3.254-1.895-4.735-3.059-1.41-1.11-2.014-2.693-2.842-4.232-2.227-4.068-4.973-8.144-9.035-10.555a6.553,6.553,0,0,0,1.419,2.589c.838,1.1,1.71,2.176,2.507,3.307a17.8,17.8,0,0,1,2.933,6.431c-.217.261-1.238-.122-1.483-.186-2.133-.592-4.205-1.447-6.456-1.407a26.4,26.4,0,0,0,6.941,4.4,5.531,5.531,0,0,1,2.138,1.611c1.312,1.686,1.434,4.119,1.66,6.156a33.319,33.319,0,0,1-1.879,16.44c-.548-4.371-2.8-8.761-6.628-11.121a7.977,7.977,0,0,0,1.721,4.77c2.672,3.789,2.315,8.693.8,12.864-2.557,2.841-5.8,4.794-8.948,6.9a35.351,35.351,0,0,0-1.265-10.27c-.06-.2-.312-1.449-.56-1.452-.211,2.107-.087,4.217-.346,6.323a22.032,22.032,0,0,1-2.294,7.333c-.306-.628-.5-1.312-.783-1.95a6.183,6.183,0,0,0-3.8-3.219,23.3,23.3,0,0,1,3.292,7.123c-1.494,1.027-2.961,2.071-4.37,3.212a13.8,13.8,0,0,1-4.206,2.238l-14.446-.021c-3.127-1.086-5.581-3.386-8.253-5.233a23.15,23.15,0,0,1,3.332-7.318,6.2,6.2,0,0,0-3.778,3.178c-.3.649-.5,1.342-.8,1.99a22.034,22.034,0,0,1-2.3-7.333c-.26-2.106-.136-4.216-.346-6.323-.249,0-.5,1.254-.56,1.452a34.907,34.907,0,0,0-1.254,10.448c-3.918-2.532-8.09-4.942-10.779-8.882a13.544,13.544,0,0,1,.487-9.588c.635-1.3,1.7-2.321,2.114-3.727a13.2,13.2,0,0,0,.462-2.516,14.92,14.92,0,0,0-6.3,9.357c-2.117-6.306-1.859-13.211-.383-19.625.578-1.792,2.439-2.546,3.951-3.395q1.76-.988,3.511-1.992a9.455,9.455,0,0,0,2.883-2.05,7.52,7.52,0,0,0-2.581.385c-1.931.514-3.856,1.052-5.779,1.6a4.646,4.646,0,0,1,.167-1.1c.541-2.51,2.14-4.542,3.664-6.536a30.173,30.173,0,0,0,3.046-4.953l-1.113.614a29.409,29.409,0,0,0-7.779,9.654,16.321,16.321,0,0,1-1.979,3.477,13.634,13.634,0,0,1-2.812,2.289c-.486.322-.977.638-1.455.972-.365.255-.967.8-1.411.39-.882-.918.441-2.976.719-4.035a25.917,25.917,0,0,1,1.678-3.913,23.729,23.729,0,0,0,3.122-6.713C439,164.009,434.3,175.06,433.6,182.559c-1.245,16.735,16.973,25.553,28.119,34.648q1.454,1.118,2.9,2.245c1.042.838,3.69,2.081,2.113,3.627-.576.44-1.4.092-2.019-.036-3.639-.589-7.326-.945-10.972-1.487-1.6-.21-3.386-1.333-4.974-.627-1.541,1-.226,2.94.437,4.1a16.531,16.531,0,0,1,1.146,2.444,6.076,6.076,0,0,0,2.944,3.452c1.715.835,3.638.632,5.469.953,2.785.643,5.9,1.008,8.1,3q.182.83.4,1.654l-.32,2.527h.93a27.741,27.741,0,0,0,.356,6.794c1.382,3.456,4.528,4.6,6.364,7.376a10.008,10.008,0,0,0-2.2-4.346c-1.87-2.713-2.31-4.452-1.137-7.454,1.58,3.068,4.125,3.668,7.921,3.942a18.6,18.6,0,0,0-.183-3.241A17.266,17.266,0,0,1,475.4,241c-2.782-1.205-5.6-3.2-4.385-5.467l.453.058c-.16-.064-.273-.146-.3-.255.432.055-.863-.565-.988-.651.212-1.605-1.187-1.834-2.293-2.041l.033-.234c2.15.487,5.515,1.647,6.836,3.084a1.08,1.08,0,0,1,.26.493,5.48,5.48,0,0,0,1.342,1.881c.32.319.8.744,1.33,1.24,1.112,1.18,2.651,1.158,3.735-.71A35.989,35.989,0,0,0,479.255,246a11.427,11.427,0,0,1-.28,2.311c-.653,3.007-2.549,5.064-3.545,9.77h-.209a8.66,8.66,0,0,0,3.565,4.325,5.721,5.721,0,0,0,7.073.725c2.234-.8,4.469-2.423,4.61-5.052l-.327,0c-1.212-5.748-3.7-7.385-3.821-12.081a32.814,32.814,0,0,0-2.17-7.609c1.567,2.464,3.023,1.615,4.754-.227a6.3,6.3,0,0,0,1.562-1.962,2.191,2.191,0,0,1,.344-.711c1.034-1.283,4.825-2.655,6.837-3.088l.036.234c-1.108.207-2.5.436-2.289,2.041-.132.094-1.374.675-.992.652-.021.109-.136.191-.3.255l.454-.057c1.895,3.7-6.375,6.395-7.984,6.6a20.173,20.173,0,0,0-.179,3.241c3.631-.389,6.013-.487,7.916-3.942a6.435,6.435,0,0,1-.645,6.717c-1.043,1.663-2.251,2.768-2.688,5.06,0,0,.008,0,.01,0,1.84-2.764,4.969-3.906,6.348-7.352a29,29,0,0,0,.359-6.794h.836l-.3-2.339c1.446-3.183,5.235-4.144,8.359-4.763a10.767,10.767,0,0,1,3.271-.331c4.156-.152,5.383-3.273,6.623-6.649,1.559-2.982,2.869-4.9-1.791-3.892-4.959.682-9.916,1.528-14.872,2.148-.861.02-1.686-.8-1.188-1.659a3.1,3.1,0,0,1,.755-.759c2.28-2.013,4.661-3.905,7.118-5.7,9.027-6.666,19.588-12.881,24.372-23.512C534.45,180.545,529.013,168.47,521.728,160.137Zm-42.771,81.82c-.143-.617-.372-.946-.737-.952C478.548,241.38,479,242.018,478.957,241.957Zm7.658,0c-.043.064.743-.953.738-.952C486.983,241.011,486.754,241.342,486.615,241.957Zm-12.624-4.982-1.5-.188c-1.14,2.113,3.416,3.861,5,4.1C476.7,239.551,474.706,238.408,473.991,236.976Zm19.091-.188-1.5.188c-.716,1.433-2.7,2.575-3.5,3.914C489.667,240.648,494.222,238.9,493.082,236.787Zm-50.953-57.6a58.178,58.178,0,0,0-.477,8.4c.08,1.414.229,2.824.362,4.234.036.378.221,1.152-.043,1.492-.359.462-.96-.175-1.216-.452-4.1-4.353-3.559-12.329,1.6-15.615C442.355,177.246,442.166,178.758,442.13,179.183ZM463.341,228.7c-1.187.081-2.38.035-4.226.035-2.62.572-5.175-.1-6.426-2.671-.183-.376-.315-.765-.476-1.149-.132-.314-.394-.65-.015-.9.313-.2.708-.039,1.019.08q5.307,2.064,10.622,4.116c.171.066.367.164.367.219,0,.029,0,.3-.159.377C463.846,228.907,463.539,228.689,463.341,228.7Zm15.2,6.92c-2.778-2.185-5.483-4.5-9.02-5.207l-.155-1.219c3.991.157,6.653,3.179,9.429,5.958A1.812,1.812,0,0,0,478.542,235.62Zm4.248,28.11a5.574,5.574,0,0,1-3.432-1.239l3.429-1.618,3.426,1.618A5.648,5.648,0,0,1,482.79,263.73Zm4.466-10.028.69,1.6-5.16,4.393-5.163-4.393.689-1.6c1.679,0,2.812,2.2,4.474,2.276C484.447,255.9,485.579,253.7,487.256,253.7Zm7.976-23.288c-3.533.7-6.24,3.022-9.017,5.207a1.808,1.808,0,0,0-.255-.469c2.776-2.778,5.439-5.8,9.43-5.958Zm11.448-4.365q2.662-1.1,5.37-2.084a2.463,2.463,0,0,1,1.723-.07c-1.251,3.286-3.4,4.669-6.916,4h-3.911C503.81,226.514,505.4,226.582,506.68,226.049ZM524.593,193.2a2.4,2.4,0,0,1-.8.214,3.633,3.633,0,0,1-.131-1.845c.133-1.966.282-3.931.421-5.9-.208-2.754-.437-5.5-.493-8.258.655.618,1.369,1.207,1.962,1.886a7.786,7.786,0,0,1,1.568,3.151C528,185.972,527.61,190.786,524.593,193.2Z" transform="translate(0)" fill="#d60812"></path></g></svg>';loadingDiv.innerHTML=loadingSvg;loadingDiv.appendChild(loadingP);loadingDiv.classList.add("loading-screen");body.appendChild(loadingDiv);const toggleLoading=()=>{if(!document.querySelector(".loading-screen"))body.appendChild(loadingDiv);body.classList.toggle("loading")};var _default=exports.default=toggleLoading},{}],10:[function(require,module,exports){"use strict";var _fetchProduct=_interopRequireDefault(require("./modules/handleProduct/fetchProduct.js"));var _toggleLoading=_interopRequireDefault(require("./modules/toggleLoading.js"));var _dataLayer=require("./modules/dataLayer.js");var _handleCart=require("./modules/handleCart.js");var _buy=_interopRequireDefault(require("./modules/buy.js"));var _fetchProductBen=_interopRequireDefault(require("./modules/handleProduct/fetchProductBen.js"));var _handleCookieBanner=_interopRequireWildcard(require("./modules/handleCookieBanner.js"));var _variables=require("./variables.js");var _intellimize=_interopRequireDefault(require("./modules/intellimize.js"));var _handlePageView=_interopRequireDefault(require("./modules/handlePageView.js"));function _getRequireWildcardCache(e){if("function"!=typeof WeakMap)return null;var r=new WeakMap,t=new WeakMap;return(_getRequireWildcardCache=function(e){return e?t:r})(e)}function _interopRequireWildcard(e,r){if(!r&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_getRequireWildcardCache(r);if(t&&t.has(e))return t.get(e);var n={__proto__:null},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&{}.hasOwnProperty.call(e,u)){var i=a?Object.getOwnPropertyDescriptor(e,u):null;i&&(i.get||i.set)?Object.defineProperty(n,u,i):n[u]=e[u]}return n.default=e,t&&t.set(e,n),n}function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}const shopifyApiCode=async lpParams=>{window.addEventListener("pageshow",(function(event){if(event.persisted){document.body.classList.remove("loading")}}));const noStock=el=>!el.availableForSale;const dontExist=btn=>!btn;const cartContainer=document.querySelector("[cart-container]")||false;(0,_toggleLoading.default)();const isBenSys="isBenSys"in lpParams;if(lpParams.country==="uk"){(0,_handleCookieBanner.default)({country:lpParams.country})}else{(0,_handleCookieBanner.tryFbq)("grant");(0,_intellimize.default)()}let data,orderBumpData;try{[data,orderBumpData]=isBenSys?await Promise.all([(0,_fetchProductBen.default)({products:lpParams.products,country:lpParams.country}),lpParams.bump&&(0,_fetchProductBen.default)({products:lpParams.bump.products,isOrderBump:true,country:lpParams.country})]):await Promise.all([(0,_fetchProduct.default)({products:lpParams.products,country:lpParams.country}),lpParams.bump&&(0,_fetchProduct.default)({products:lpParams.bump.products,isOrderBump:true,country:lpParams.country})])}catch(e){(0,_variables.trySentry)({error:e});(0,_variables.handleError)();return}if(data.some(noStock)){(0,_variables.handleError)();return}(0,_dataLayer.dataLayerStart)(lpParams.dataLayer,data,lpParams.discountCode);const buttons=Object.keys(lpParams.buttons).map((id=>document.getElementById(id)));if(buttons.some(dontExist)&&!cartContainer){(0,_variables.trySentry)({message:"Wrong button id."});(0,_variables.handleError)();return}const handleBtnNoCart=btn=>{btn.addEventListener("click",(()=>{let btnData;const btnProducts=lpParams.buttons[btn.id].products;const filteredData=btnProducts?data.filter((prod=>prod.id in btnProducts)):data;filteredData.forEach((prod=>prod.quantity=btnProducts&&btnProducts[prod.id].quantity||lpParams.products[prod.id].quantity||1));btnData=filteredData;(0,_buy.default)({data:btnData,btnDiscount:lpParams.buttons[btn.id].discountCode,lpParams:lpParams,noCart:true})}))};if(lpParams.noCart){buttons.forEach(handleBtnNoCart)}else{const updateCartProducts=(0,_handleCart.createCart)(data,orderBumpData?.some(noStock)&&orderBumpData[0]!=="increase"?undefined:orderBumpData,lpParams);if(cartContainer){const increasedData=data;data.forEach((prod=>{const quantity=lpParams.products[prod.id].quantity;if(quantity>1&&!prod.isWhole&&prod.variants?.length>1){for(let i=1;i<quantity;i++){const copy={...prod,id:`${prod.id}id${i}`};increasedData.push(copy)}}}));updateCartProducts(increasedData,undefined,undefined,undefined)}else{buttons.forEach((btn=>{if(lpParams.buttons[btn.id].noCart){handleBtnNoCart(btn);return}btn.addEventListener("click",(()=>{let btnData;const btnProducts=lpParams.buttons[btn.id].products;const increasedData=[];data.forEach((prod=>{if(btnProducts&&prod.id in btnProducts||!btnProducts){increasedData.push(prod)}const quantity=btnProducts&&btnProducts[prod.id]?.quantity||lpParams.products[prod.id].quantity;if(quantity>1&&!prod.isWhole&&prod.variants?.length>1&&(btnProducts&&prod.id in btnProducts||!btnProducts)){for(let i=1;i<quantity;i++){const copy={...prod,id:`${prod.id}id${i}`};increasedData.push(copy)}}}));btnData=increasedData;updateCartProducts(btnData,lpParams.buttons[btn.id].discountCode,btnProducts,lpParams.buttons[btn.id].prices)}))}))}}(0,_toggleLoading.default)()};window.shopifyApiCode=shopifyApiCode},{"./modules/buy.js":1,"./modules/dataLayer.js":2,"./modules/handleCart.js":3,"./modules/handleCookieBanner.js":4,"./modules/handlePageView.js":5,"./modules/handleProduct/fetchProduct.js":6,"./modules/handleProduct/fetchProductBen.js":7,"./modules/intellimize.js":8,"./modules/toggleLoading.js":9,"./variables.js":11}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.trySentry=exports.handleFetch=exports.handleError=exports.getBenProducts=exports.getAccessToken=void 0;const getAccessToken=country=>{switch(country){case"ca":return"3461c5b0c16a619e59715ef4d3b64731";case"au":return"eea8ddd81a7096b8ce5e04a33234ca39";case"uk":return"d74f7d27c6deb652e0c7257e91024c87";default:return"3f0fe03b9adb374eee07d99b57da77bd"}};exports.getAccessToken=getAccessToken;const getFetchUrl=country=>{switch(country){case"ca":return"https://cad.buckedup.com/api/2025-01/graphql.json";case"au":return"https://aud.buckedup.com/api/2025-01/graphql.json";case"uk":return"https://gbp.buckedup.com/api/2025-01/graphql.json";default:return"https://secure.buckedup.com/api/2025-01/graphql.json"}};const getApiOptions=country=>({method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":getAccessToken(country)}});const handleFetch=async({body:body,country:country})=>{const response=await fetch(getFetchUrl(country),{...getApiOptions(country),body:JSON.stringify(body)});return response};exports.handleFetch=handleFetch;const getBenProducts=async({ids:ids,country:country})=>{let fetchUrl="https://ar5vgv5qw5.execute-api.us-east-1.amazonaws.com/list/";const fetchApi=async id=>{let url=`${fetchUrl}${id}`;if(country&&country!=="us")url=url+`?country=${country}`;try{const response=await fetch(url);if(response.status===404)throw new Error(`Product ${id} Not Found.`);if(response.status==500||response.status==400)throw new Error("Sorry, there was a problem.");const data=await response.json();return data}catch(error){return Promise.reject(error)}};const data=await Promise.all(ids.map(fetchApi));return data.map((data=>data.product))};exports.getBenProducts=getBenProducts;const trySentry=({error:error,message:message})=>{try{if(error){console.error(error);Sentry.captureException(error)}else{console.error(message);const sentryError=new Error;sentryError.name="Error";sentryError.message=message;Sentry.captureException(sentryError)}}catch(e){console.error("Error loading sentry.")}};exports.trySentry=trySentry;const handleError=()=>{document.body.classList.add("error");setTimeout((()=>{window.location.href="https://buckedup.com"}),3e3)};exports.handleError=handleError},{}]},{},[10]);